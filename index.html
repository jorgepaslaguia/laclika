<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Jefe de cocina digital</title>
    <link rel="stylesheet" href="styles.css" />

  </head>
  <body>
    <header class="topbar">
      <div class="topbar-left">
        <div class="brand-name">JEFE DE COCINA DIGITAL</div>
        <div class="brand-context" id="plan-title">BIBLIOTECA</div>
      </div>
      <nav class="nav-tabs" aria-label="Navegacion principal">
        <button id="mode-library" class="btn ghost" type="button">Biblioteca</button>
        <button id="mode-prep" class="btn ghost" type="button">Preparacion</button>
        <button id="mode-kitchen" class="btn ghost" type="button">Cocina</button>
      </nav>
      <div class="topbar-right">
        <button id="health-details" class="badge-button" type="button" aria-label="Avisos">
          <span id="plan-health"></span>
        </button>
        <button id="new-recipe" class="btn primary library-only" type="button">Nueva receta</button>
        <button id="start-service" class="btn success" type="button">Iniciar servicio</button>
        <details id="more-menu" class="more-menu">
          <summary class="btn ghost" aria-label="Mas opciones">...</summary>
          <div class="more-menu-panel">
            <button id="nav-back" class="btn ghost" type="button">Volver</button>
            <button id="import-pdf" class="btn ghost library-only" type="button">Importar PDF</button>
            <button id="auto-review" class="btn ghost prep-only" type="button">Preparar plan automaticamente</button>
            <button id="advanced-toggle" class="btn ghost" type="button">Detalles</button>
          </div>
        </details>
      </div>
    </header>
    <div class="app">
      <section id="library-screen" class="screen library-screen">
        <div id="view-library" class="library-body">
          <div class="library-filters">
            <select id="recipe-filter"></select>
          </div>
          <div id="recipe-list" class="recipe-grid"></div>
          <div id="recipe-empty" class="note"></div>
        </div>
      </section>

      <section id="plan-screen" class="screen plan-screen">
        <section id="view-prep" class="prep-only">
          <section class="section" id="upload">
          <div class="section-title">Cargar menu</div>
          <div id="pdfDropZone" class="drop-zone">
            <button class="btn primary" type="button">Cargar menu (PDF o texto)</button>
            <div class="drop-sub">Arrastra y suelta aqui o pulsa el boton</div>
          </div>
          <div id="pdfStatus" class="note">Sin archivo cargado.</div>
          <details id="pdf-error-panel" class="note" style="display:none">
            <summary>Detalles del error</summary>
            <pre id="pdf-error-text" class="note"></pre>
          </details>
          <div class="controls">
            <button id="manual-toggle" class="btn ghost" type="button">Editar texto</button>
            <label class="note expert-only">
              <input id="debug-toggle" type="checkbox" />
              Debug texto
            </label>
          </div>
          <div id="manual-box" class="manual-box">
            <textarea
              id="menuTextArea"
              class="text-input"
              placeholder="Pega el texto del menu aqui si es necesario"
            ></textarea>
            <div class="controls">
              <button id="btnInterpret" class="btn ghost">Interpretar texto</button>
            </div>
          </div>
          <details id="debug-panel" class="debug-panel expert-only">
            <summary>Debug</summary>
            <div id="smoke-results" class="note debug"></div>
            <textarea id="debug-text" class="text-input debug" readonly></textarea>
          </details>
          </section>

          <section class="section" id="ai-summary">
            <div class="section-title">Resumen de interpretacion</div>
            <div id="ai-summary-content" class="note">Sin interpretacion aun.</div>
            <div id="alerts-box" class="alert-box">
              <div class="alert-title">Alertas (<span id="alerts-count">0</span>)</div>
              <div id="alerts-lines" class="note">Sin alertas.</div>
              <div class="controls">
                <button id="alerts-review" class="btn ghost">Ver</button>
                <button id="alerts-dismiss" class="btn ghost">Ignorar por ahora</button>
              </div>
            </div>
            <div id="alerts-panel" class="alert-panel">
              <div class="alert-section">
                <div class="label">Recursos faltantes</div>
                <div id="alerts-missing" class="note">Sin recursos faltantes.</div>
                <button id="alerts-add-resources" class="btn ghost mini-btn">
                  Anadir recursos sugeridos
                </button>
              </div>
              <div class="alert-section">
                <div class="label">Preguntas guiadas</div>
                <div id="questions-list" class="questions"></div>
              </div>
              <div class="alert-section" id="alerts-fixes-section" style="display:none">
                <div class="label">Correcciones aplicadas</div>
                <div id="alerts-fixes" class="note">Sin correcciones.</div>
              </div>
            </div>
          </section>

          <section class="section" id="config">
            <div class="section-title">Recursos y equipo</div>
            <div class="config-grid">
              <div class="config-block">
                <div class="label">Recursos</div>
                <div id="resource-summary" class="note"></div>
                <div id="resource-editor"></div>
                <button id="add-resource" class="btn ghost mini-btn">+ Anadir recurso</button>
              </div>
              <div class="config-block">
                <div class="label">Equipo</div>
                <div id="team-editor"></div>
                <button id="add-person" class="btn ghost mini-btn">+ Anadir persona</button>
              </div>
            </div>
            <div class="controls">
            </div>
          </section>

          <details id="advanced-panel" class="settings-panel">
            <summary class="panel-title">Ajustes</summary>
            <div class="settings-body">
              <div class="settings-block">
                <div class="block-title">Arreglar plan</div>
                <div class="controls">
                  <button id="bulk-resolve" class="btn primary">Resolver todo automaticamente</button>
                  <button id="save-recipe" class="btn">Guardar receta</button>
                  <button id="save-as-recipe" class="btn ghost">Guardar como nueva</button>
                </div>
                <div class="controls expert-only">
                  <label class="note">
                    <input id="resolve-durations" type="checkbox" checked />
                    Autocompletar duraciones
                  </label>
                  <label class="note">
                    <input id="resolve-resources" type="checkbox" checked />
                    Asignar recursos
                  </label>
                  <label class="note">
                    <input id="resolve-balance" type="checkbox" checked />
                    Reequilibrar equipo
                  </label>
                </div>
                <div id="plan-status" class="note"></div>
                <div class="plan-issues expert-only">
                  <div class="label">Que falta para empezar</div>
                  <div id="validation-list" class="validation"></div>
                </div>
              </div>

              <div class="settings-block">
                <div class="block-title">Optimizar</div>
                <div class="controls">
                  <button id="rebalance-team" class="btn">Reequilibrar equipo</button>
                  <button id="calc-plan" class="btn ghost">Recalcular ruta optima</button>
                </div>
              </div>

              <div class="settings-block expert-toggle-block">
                <div class="block-title">Modo experto</div>
                <label class="note">
                  <input id="expert-toggle" type="checkbox" />
                  Activar modo experto
                </label>
              </div>

              <details class="settings-block danger-zone expert-only">
                <summary class="block-title">Avanzado</summary>
                <div class="controls">
                  <button id="unlock-assignments" class="btn danger">Desbloquear tareas</button>
                  <button id="fix-durations" class="btn ghost">Autocompletar duraciones</button>
                  <button id="fix-resources" class="btn ghost">Asignar recursos</button>
                  <button id="auto-assign-balanced" class="btn ghost">Autoasignar equilibrado</button>
                  <button id="auto-assign-all" class="btn ghost">Autoasignar todo</button>
                  <button id="auto-assign-phase" class="btn ghost">Autoasignar fase actual</button>
                  <button id="approve-plan" class="btn ghost">Aprobar y programar</button>
                  <button id="start-phase" class="btn ghost">Iniciar fase</button>
                  <button id="skip-prestart" class="btn ghost">Saltar</button>
                  <button id="prev-phase" class="btn ghost">Retroceder</button>
                  <button id="next-phase" class="btn ghost">Avanzar</button>
                </div>
              </details>
            </div>
          </details>

          <section id="prep-screen" class="prep-screen">
          <section class="section" id="prep-issues">
            <div class="section-title">Que falta para empezar</div>
            <div id="prep-issues-grid" class="issue-grid"></div>
          </section>
          <section class="section" id="review">
            <div class="section-title">Revisar tareas</div>
            <div class="table-meta">
              <div id="incomplete-count" class="note">Errores bloqueantes: 0 | Avisos: 0</div>
              <div id="normalized-count" class="note"></div>
              <label class="note">
                <input id="toggle-compact" type="checkbox" />
                Modo compacto
              </label>
            </div>
            <div class="filters">
              <select id="filter-plato"></select>
              <select id="filter-fase"></select>
              <label class="note">
                <input id="filter-errors" type="checkbox" />
                Mostrar todas
              </label>
              <label class="note">
                <input id="filter-no-duration" type="checkbox" />
                Sin duracion
              </label>
              <label class="note">
                <input id="filter-no-resource" type="checkbox" />
                Sin recurso requerido
              </label>
            </div>
            <div id="assignment-list" class="assign-grid"></div>
          </section>
          <section class="section" id="prep-context">
            <div class="section-title">Contexto</div>
            <div class="context-grid">
              <div class="context-block">
                <div class="label">Recursos disponibles</div>
                <div id="prep-resources" class="note"></div>
              </div>
              <div class="context-block">
                <div class="label">Equipo activo</div>
                <div id="prep-team" class="note"></div>
              </div>
            </div>
          </section>
          <section class="section" id="prep-ready">
            <div class="ready-title">Plan listo para el servicio</div>
            <button id="go-kitchen" class="btn primary">Ir a Cocina</button>
          </section>
          </section>
        </section>

        <section id="view-kitchen" class="kitchen-only">
          <section class="section" id="resources">
            <div class="section-title">Recursos ocupados</div>
            <div id="resource-list" class="resource-grid"></div>
          </section>

          <section class="section" id="line">
            <div class="section-title">Linea de produccion</div>
            <div id="line-note" class="note"></div>
            <div id="line-columns" class="line-grid"></div>
          </section>

          <footer class="kitchen-footer">
            <button id="pause-phase" class="btn">Pausar</button>
            <button id="finalize-phase" class="btn ghost">Finalizar fase</button>
          </footer>
        </section>
      </section>
    </div>

    <input id="pdfInput" type="file" accept="application/pdf" hidden />

    <div id="finish-screen" class="finish-screen">A COMER, A BEBER Y a FUMAR</div>

    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script defer src="core.js"></script>
    <script defer src="app.js"></script>
  </body>
</html>
