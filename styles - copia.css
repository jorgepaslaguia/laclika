:root {
        --bg: #f7f7f7;
        --bg-soft: #efefef;
        --ink: #000;
        --muted: #4a4a4a;
        --accent: #1f5fbf;
        --warn: #b07b00;
        --danger: #b23a3a;
        --success: #2f7d4a;
        --primary: #111111;
        --secondary: #e2e2e2;
        --line: #c7c7c7;
        --ticket: #ffffff;
        --done: #f0f0f0;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: Consolas, 'Courier New', monospace;
        color: var(--ink);
        background: repeating-linear-gradient(
            0deg,
            var(--bg) 0,
            var(--bg) 24px,
            var(--bg-soft) 24px,
            var(--bg-soft) 25px
          );
        min-height: 100vh;
        padding-top: 0;
      }

      html {
        scroll-padding-top: var(--topbar-h, 86px);
      }

      .app {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .screen {
        display: block;
      }

      body.screen-library #plan-screen {
        display: none;
      }

      body.screen-plan #library-screen {
        display: none;
      }

      .library-topbar {
        border: 1px solid var(--line);
        padding: 14px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        background: #fff;
      }

      .library-body {
        margin-top: 16px;
        display: grid;
        gap: 16px;
      }

      .library-filters {
        display: flex;
        justify-content: flex-end;
        gap: 8px;
      }

      .recipe-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 12px;
      }

      .recipe-card {
        border: 1px dashed var(--line);
        padding: 10px;
        background: #fff;
        display: grid;
        gap: 6px;
      }

      .recipe-card.active {
        border-color: var(--ink);
      }

      .recipe-title {
        font-size: 13px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.1em;
      }

      .recipe-meta,
      .recipe-tags {
        font-size: 11px;
        color: var(--muted);
      }

      .recipe-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }

      .topbar {
        border-bottom: 1px solid var(--line);
        padding: 8px 16px;
        display: grid;
        grid-template-columns: auto minmax(0, 1fr) auto;
        gap: 12px;
        align-items: center;
        background: #fff;
        position: sticky;
        top: 0;
        left: 0;
        right: 0;
        z-index: 50;
        min-height: 64px;
      }

      @media (max-width: 920px) {
        .topbar {
          grid-template-columns: 1fr;
          align-items: start;
        }

        .top-center {
          justify-items: start;
        }

        .nav-tabs {
          flex-wrap: wrap;
          justify-content: flex-start;
        }

        .top-actions {
          justify-content: flex-start;
        }
      }

      .top-center {
        display: grid;
        justify-items: center;
        gap: 2px;
        min-width: 0;
      }

      .top-actions {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: flex-end;
        gap: 10px;
      }

      .nav-tabs {
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }

      .nav-tabs .btn {
        border-bottom: 2px solid transparent;
      }

      .nav-tabs .btn.active {
        border-bottom-color: var(--ink);
      }

      .jump-highlight {
        outline: 2px solid var(--warn);
        outline-offset: 4px;
      }

      body.screen-library .topbar .status-strip,
      body.screen-library .topbar #phase-state,
      body.screen-library .topbar #phase-timer-note,
      body.screen-library .topbar #auto-review,
      body.screen-library .topbar #start-service,
      body.screen-library .topbar #advanced-toggle {
        display: none;
      }

      .brand {
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.16em;
        font-weight: 700;
        display: grid;
        gap: 2px;
      }

      .brand-name {
        font-size: 11px;
        letter-spacing: 0.16em;
      }

      .brand-context {
        font-size: 13px;
        font-weight: 700;
      }

      .status-strip {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
        font-size: 11px;
        justify-content: center;
      }

      .status-notes {
        display: none;
        gap: 8px;
        font-size: 10px;
        color: var(--muted);
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      body.expert .status-notes {
        display: flex;
      }

      .status-badge.health {
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }

      .status-badge.health::before {
        content: '';
        width: 10px;
        height: 10px;
        border-radius: 2px;
        background: var(--muted);
        display: inline-block;
      }

      .status-badge.health.ok::before {
        background: var(--success);
      }

      .status-badge.health.warn::before {
        background: var(--warn);
      }

      .status-badge.health.error::before {
        background: var(--danger);
      }

      #plan-screen {
        padding-bottom: 76px;
      }

      .status-timer.hidden {
        display: none;
      }

      .kitchen-footer {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        background: #fff;
        border-top: 1px dashed var(--line);
        padding: 10px 14px;
        display: flex;
        justify-content: center;
        gap: 10px;
        z-index: 20;
      }

      body.mode-prep .kitchen-footer {
        display: none;
      }

      .status-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 4px 8px;
        border-radius: 4px;
        border: 1px solid var(--line);
        text-transform: uppercase;
        letter-spacing: 0.12em;
        font-weight: 700;
        background: #fff;
      }

      .status-badge.phase {
        border-color: var(--ink);
        padding: 6px 10px;
        font-size: 12px;
      }

      .status-badge.ok {
        background: #e8f4ec;
        border-color: #98c8ab;
        color: #1f5a37;
      }

      .status-badge.warn {
        background: #fff5db;
        border-color: #f0c96b;
        color: #8a5a00;
      }

      .status-badge.error {
        background: #fdecec;
        border-color: #d99a9a;
        color: #8b1a1a;
      }

      .status-timer {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 4px 8px;
        border: 1px dashed var(--line);
        border-radius: 4px;
        font-weight: 700;
        letter-spacing: 0.08em;
      }

      #phase-state,
      #phase-timer-note {
        display: none;
      }

      .label {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        color: var(--muted);
      }

      .value {
        font-size: 18px;
        font-weight: 700;
      }

      .value.warn {
        color: var(--warn);
      }

      .note {
        font-size: 12px;
        color: var(--muted);
      }

      .summary-status {
        font-size: 12px;
        font-weight: 700;
        letter-spacing: 0.08em;
        text-transform: uppercase;
      }

      .summary-meta {
        font-size: 12px;
        color: var(--muted);
      }

      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        align-items: center;
      }

      .main-actions .btn {
        font-size: 12px;
      }

      .main-actions {
        justify-content: flex-end;
      }

      .library-only {
        display: none;
      }

      body.screen-library .library-only {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .more-menu {
        position: relative;
      }

      .more-menu summary {
        list-style: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .more-menu summary::-webkit-details-marker {
        display: none;
      }

      .more-menu-panel {
        margin-top: 6px;
        border: 1px solid var(--line);
        padding: 8px;
        background: #fff;
        display: none;
        gap: 6px;
      }

      .more-menu[open] .more-menu-panel {
        display: grid;
      }

      .more-menu[open] .more-menu-panel {
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
      }

      .hidden {
        display: none !important;
      }

      [hidden] {
        display: none !important;
      }

      .mode-toggle {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-top: 6px;
      }

      .panel-actions .mode-toggle,
      .more-menu-panel .mode-toggle {
        margin-top: 0;
      }

      .mode-toggle .btn.active {
        background: var(--ink);
        color: var(--bg);
      }

      .btn {
        border: 1px solid var(--line);
        background: var(--secondary);
        color: var(--ink);
        padding: 6px 10px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        font-size: 11px;
        font-family: inherit;
        cursor: pointer;
      }

      .btn.ghost {
        background: transparent;
        color: var(--accent);
        border-color: var(--accent);
      }

      .btn.primary {
        background: var(--primary);
        color: #fff;
        border-color: var(--primary);
      }

      .btn.success {
        background: var(--success);
        color: #fff;
        border-color: var(--success);
      }

      .btn.danger {
        background: var(--danger);
        color: #fff;
        border-color: var(--danger);
      }

      .btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      .section {
        margin-top: 16px;
        border: 1px solid var(--line);
        padding: 12px;
        background: var(--ticket);
      }

      .wizard {
        display: grid;
        gap: 16px;
        margin-top: 16px;
      }

      .step {
        border: 1px solid var(--line);
        background: #fff;
        padding: 12px;
        display: grid;
        gap: 10px;
      }

      .step-header {
        display: flex;
        align-items: center;
        gap: 10px;
        border-bottom: 1px solid var(--line);
        padding-bottom: 6px;
      }

      .step-index {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.18em;
        padding: 4px 8px;
        border: 1px solid var(--line);
        background: var(--bg-soft);
      }

      .step-title {
        font-size: 15px;
        font-weight: 700;
        letter-spacing: 0.12em;
        text-transform: uppercase;
      }

      .step-body {
        display: grid;
        gap: 12px;
      }

      .config-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 10px;
        margin-top: 8px;
      }

      .config-block {
        border: 1px dashed var(--line);
        padding: 8px;
        background: #fff;
        display: grid;
        gap: 6px;
      }

      .config-row {
        display: grid;
        gap: 6px;
        grid-template-columns: 1fr 70px 90px 32px;
        align-items: center;
      }

      .config-row.team {
        grid-template-columns: 1fr 0.9fr 60px 32px;
      }

      .mini-btn {
        padding: 4px 6px;
        font-size: 10px;
      }

      .section-title {
        font-size: 16px;
        letter-spacing: 0.18em;
        text-transform: uppercase;
        margin-bottom: 10px;
      }

      .drop-zone {
        border: 1px dashed var(--line);
        background: #fff;
        padding: 18px;
        text-align: center;
        cursor: pointer;
        display: grid;
        gap: 6px;
      }

      .drop-zone .btn.primary {
        padding: 10px 14px;
        font-size: 12px;
      }

      .drop-zone.hover {
        border-color: var(--ink);
        background: #f0f0f0;
      }

      .drop-title {
        font-size: 13px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .drop-sub {
        font-size: 11px;
        color: var(--muted);
      }

      .text-input {
        width: 100%;
        min-height: 90px;
        margin-top: 8px;
        padding: 8px;
        border: 1px dashed var(--line);
        font-family: inherit;
        font-size: 12px;
        background: #fff;
      }

      .text-input.debug {
        min-height: 120px;
      }

      .alert-box {
        border: 1px dashed var(--line);
        padding: 10px;
        display: grid;
        gap: 6px;
        background: #fff;
      }

      .alert-title {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        font-weight: 700;
      }

      .alert-panel {
        border: 1px dashed var(--line);
        padding: 10px;
        margin-top: 8px;
        display: none;
        gap: 10px;
        background: #fff;
      }

      .alert-panel.show {
        display: grid;
      }

      .alert-section {
        border-top: 1px dashed var(--line);
        padding-top: 8px;
        display: grid;
        gap: 6px;
      }

      .debug-panel {
        border: 1px dashed var(--line);
        margin-top: 8px;
        display: none;
        padding: 8px;
        background: #fff;
      }

      .debug-panel.show {
        display: block;
      }

      .debug-panel summary {
        cursor: pointer;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        margin-bottom: 6px;
      }

      .debug-panel .note.debug {
        font-size: 12px;
        border-top: 1px dashed var(--line);
        padding-top: 6px;
        margin-top: 6px;
        white-space: pre-wrap;
      }

      .filters {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-top: 8px;
      }

      .table-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
        margin-top: 6px;
      }

      .plan-issues {
        margin-top: 8px;
        border: 1px solid var(--line);
        padding: 8px;
        display: grid;
        gap: 6px;
        background: #fff;
      }

      .assign-grid {
        display: grid;
        gap: 0;
        border-top: 1px dashed var(--line);
        margin-top: 8px;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }

      .prep-screen {
        display: grid;
        gap: 14px;
      }

      .issue-grid {
        display: grid;
        gap: 8px;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }

      .issue-card {
        border: 1px dashed var(--line);
        padding: 10px;
        background: #fff;
        display: grid;
        gap: 6px;
      }

      .issue-card.error {
        border-color: var(--danger);
        background: #fdecec;
      }

      .issue-card.warn {
        border-color: var(--warn);
        background: #fff4d6;
      }

      .issue-title {
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .issue-meta {
        font-size: 11px;
        color: var(--muted);
      }

      .context-grid {
        display: grid;
        gap: 10px;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }

      .context-block {
        border: 1px dashed var(--line);
        padding: 10px;
        background: #fff;
      }

      .ready-title {
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .assign-row {
        display: grid;
        grid-template-columns: minmax(180px, 1.2fr) 0.7fr 0.7fr 0.9fr 0.6fr;
        gap: 8px;
        padding: 6px 0;
        border-bottom: 1px dashed var(--line);
        font-size: 11px;
        align-items: center;
        min-width: 640px;
      }

      body.expert .assign-row {
        grid-template-columns: minmax(180px, 1.2fr) 0.7fr 0.7fr 0.7fr 0.7fr 0.6fr 0.7fr 0.6fr;
        min-width: 820px;
      }

      .assign-grid[data-mode='prep'] .assign-row {
        grid-template-columns: minmax(180px, 1.2fr) 0.7fr 0.7fr 0.8fr 0.6fr 0.7fr;
        min-width: 760px;
      }

      .assign-row.header {
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .assign-row.incomplete,
      .assign-row.missing {
        background: #fdecec;
        border-left: 3px solid var(--danger);
        padding-left: 6px;
      }

      .assign-row.invalid {
        color: var(--danger);
        background: #f5f5f5;
      }

      .assign-row.incomplete.invalid {
        background: #fdecec;
      }

      .assign-row.warning {
        background: #fff4d6;
        border-left: 3px solid #e0b542;
        padding-left: 6px;
      }

      .assign-row.low {
        background: #f3f3f3;
      }

      .state-icon {
        display: inline-block;
        min-width: 16px;
        text-align: center;
        margin-right: 4px;
      }

      .badge {
        display: inline-block;
        font-size: 9px;
        padding: 2px 4px;
        border: 1px dashed var(--line);
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .badge.incomplete {
        border-color: var(--danger);
        color: var(--danger);
      }

      .badge.warning {
        border-color: #e0b542;
        color: #8a5a00;
      }

      .badge.state {
        color: var(--ink);
      }

      .field-missing {
        border-color: var(--danger);
      }


      .cell strong {
        font-weight: 700;
        display: inline-block;
        max-width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      select,
      input[type='number'],
      input[type='text'] {
        width: 100%;
        font-family: inherit;
        font-size: 12px;
        padding: 4px;
        border: 1px dashed var(--line);
        background: #fff;
      }

      .validation {
        margin-top: 8px;
        border-top: 1px dashed var(--line);
        padding-top: 8px;
      }

      .validation-item {
        font-size: 12px;
        margin-bottom: 6px;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        gap: 6px;
      }

      .validation-item.error {
        color: var(--danger);
        background: #fdecec;
        border-left: 3px solid var(--danger);
        padding: 6px;
      }

      .validation-item.warn {
        color: var(--warn);
        background: #fff4d6;
        border-left: 3px solid var(--warn);
        padding: 6px;
      }

      .issue-bar {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        align-items: center;
        padding: 6px;
        border: 1px dashed var(--line);
        background: #fff;
        font-size: 11px;
      }

      .issue-bar.error {
        border-color: var(--danger);
        background: #fdecec;
      }

      .issue-bar.warn {
        background: #fff4d6;
      }

      .issue-bar.ok {
        background: #e8f4ec;
        border-color: #98c8ab;
      }

      .issue-panel {
        margin-top: 6px;
        border: 1px dashed var(--line);
        padding: 6px;
        background: #fff;
        display: none;
      }

      .issue-panel.show {
        display: block;
      }

      .settings-panel {
        margin-top: 16px;
        border: 1px solid var(--line);
        padding: 8px;
        background: #fff;
      }

      .settings-panel[open] {
        display: block;
      }

      .settings-panel > summary {
        cursor: pointer;
      }

      .panel-header {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        border-bottom: 1px solid var(--line);
        padding-bottom: 6px;
        margin-bottom: 8px;
      }

      .panel-title {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.14em;
      }

      .panel-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
      }

      .settings-block {
        border: 1px solid var(--line);
        padding: 8px;
        display: grid;
        gap: 6px;
        margin-bottom: 8px;
        background: #fff;
      }

      .settings-body {
        display: grid;
        gap: 12px;
        margin-top: 10px;
      }

      details.settings-block {
        padding: 0;
      }

      details.settings-block > summary {
        cursor: pointer;
        padding: 8px;
      }

      details.settings-block > .controls,
      details.settings-block > .note {
        padding: 0 8px 8px 8px;
      }

      .block-title {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.12em;
      }

      .block-details {
        border-top: 1px dashed var(--line);
        padding-top: 6px;
        display: grid;
        gap: 6px;
      }

      .block-details summary {
        cursor: pointer;
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.12em;
      }

      .danger-zone {
        border-color: var(--danger);
        background: #fdecec;
      }

      .expert-only {
        display: none;
      }

      body.expert .expert-only {
        display: block;
      }

      body.expert .expert-only.controls {
        display: flex;
      }

      body:not(.expert) .expert-only {
        display: none !important;
      }

      .service-only {
        display: none;
      }

      body.service-active .service-only {
        display: grid;
      }

      body.service-active .service-hide {
        display: none;
      }

      body.service-active #auto-review {
        display: none;
      }

      .issue-list {
        display: grid;
        gap: 6px;
        max-height: 220px;
        overflow: auto;
      }

      .issue-item {
        display: flex;
        gap: 8px;
        align-items: center;
        justify-content: space-between;
        font-size: 11px;
        border-bottom: 1px dashed var(--line);
        padding-bottom: 4px;
      }

      .issue-actions {
        display: flex;
        gap: 6px;
        flex-shrink: 0;
      }

      .pulse-error {
        animation: pulseError 2s ease;
        border: 1px solid var(--danger);
        background: #fdecec;
      }

      .field-focus {
        border-color: var(--danger);
      }

      @keyframes pulseError {
        0% {
          box-shadow: 0 0 0 0 rgba(176, 0, 0, 0.2);
        }
        70% {
          box-shadow: 0 0 0 6px rgba(176, 0, 0, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(176, 0, 0, 0);
        }
      }

      .questions {
        margin-top: 8px;
        border-top: 1px dashed var(--line);
        padding-top: 8px;
      }

      .question-item {
        font-size: 12px;
        margin-bottom: 6px;
        display: grid;
        gap: 4px;
      }

      .resource-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 10px;
      }

      .resource-item {
        border: 1px dashed var(--line);
        padding: 8px;
        background: #fff;
        display: grid;
        gap: 4px;
      }

      .resource-item[data-state='occupied'] {
        border-color: #e0b542;
        background: #fff7e0;
      }

      .resource-item[data-state='blocked'] {
        border-color: var(--danger);
        background: #fdecec;
      }

      .resource-item[data-state='free'] {
        border-color: #98c8ab;
        background: #e8f4ec;
      }

      .resource-name {
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .resource-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 20px;
        height: 20px;
        border: 1px solid var(--line);
        font-size: 10px;
      }

      .resource-meta {
        font-size: 11px;
        color: var(--muted);
      }

      .line-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 10px;
      }

      .person-column {
        border: 1px dashed var(--line);
        padding: 10px;
        background: #fff;
        display: grid;
        gap: 8px;
      }

      .person-header {
        border-bottom: 1px dashed var(--line);
        padding-bottom: 6px;
        display: grid;
        gap: 4px;
      }

      .person-name {
        font-size: 13px;
        font-weight: 700;
      }

      .person-role {
        font-size: 11px;
        color: var(--muted);
      }

      .person-state {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
      }

      .person-lanes {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 8px;
      }

      .lane-col {
        display: grid;
        gap: 6px;
      }

      .lane-title {
        font-size: 10px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: var(--muted);
      }

      .person-state.ready {
        color: var(--ink);
      }

      .person-detail {
        font-size: 10px;
        color: var(--muted);
      }

      .column-note {
        font-size: 10px;
        color: var(--muted);
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .lane {
        display: grid;
        gap: 8px;
        min-height: 120px;
      }

      .ticket {
        border: 1px dashed var(--line);
        padding: 8px;
        background: var(--ticket);
        display: grid;
        gap: 4px;
        cursor: pointer;
      }

      .ticket.pending {
        border-left: 4px solid var(--muted);
      }

      .ticket.active {
        border-left: 4px solid var(--ink);
        border-width: 2px;
      }

      .ticket.done {
        background: var(--done);
        opacity: 0.6;
      }

      .ticket.blocked {
        border-left: 4px solid var(--danger);
        background: #fcecec;
      }

      .ticket.flash {
        animation: flash 0.5s ease;
      }

      .ticket-title {
        font-size: 11px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .infer-icon {
        display: inline-block;
        font-size: 11px;
        margin-left: 4px;
        color: var(--muted);
      }

      .ticket-line {
        font-size: 11px;
        display: flex;
        justify-content: space-between;
        gap: 6px;
      }

      .ticket-meta {
        font-size: 10px;
        color: var(--muted);
      }

      .ticket-alert {
        color: var(--ink);
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .ticket-actions .btn {
        width: 100%;
      }

      .line-phase {
        font-size: 16px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.12em;
      }

      .timer.overdue {
        color: var(--ink);
      }

      .empty {
        text-transform: uppercase;
        font-size: 11px;
        color: var(--muted);
        text-align: center;
        padding: 10px;
      }

      .finish-screen {
        position: fixed;
        inset: 0;
        background: #fff;
        color: #000;
        display: none;
        align-items: center;
        justify-content: center;
        font-size: clamp(1.5rem, 4vw, 3rem);
        text-align: center;
        letter-spacing: 0.08em;
        z-index: 100;
      }

      .finish-screen.show {
        display: flex;
      }

      @keyframes flash {
        0% {
          background: #fff;
        }
        50% {
          background: #f0f0f0;
        }
        100% {
          background: var(--done);
        }
      }

      @media (max-width: 1000px) {
        .line-grid {
          grid-template-columns: 1fr;
        }

        .person-lanes {
          grid-template-columns: 1fr;
        }
      }

      body.compact .assign-row {
        padding: 4px 0;
        font-size: 10px;
      }

      body.compact .lane {
        gap: 6px;
        min-height: 80px;
      }

      body.compact .ticket {
        padding: 6px;
        gap: 3px;
      }

      body.compact .person-column {
        padding: 8px;
        gap: 6px;
      }

      body.compact .person-header {
        padding-bottom: 4px;
      }

      body.mode-kitchen .prep-only {
        display: none;
      }

      body.mode-kitchen #phase-state,
      body.mode-kitchen #phase-timer-note {
        display: none;
      }

      body.mode-kitchen .settings-panel {
        display: none;
      }

      body.mode-prep .kitchen-only {
        display: none;
      }

      body.screen-library .prep-only,
      body.screen-library .kitchen-only {
        display: none;
      }

      body.mode-kitchen #advanced-toggle {
        display: none;
      }

      body:not(.expert) .settings-panel .settings-block {
        display: none;
      }

      body:not(.expert) .settings-panel .expert-toggle-block {
        display: block;
      }

      body.screen-plan .library-filters {
        display: none;
      }

      body.mode-prep #active-phase,
      body.mode-prep #phase-timer-wrap,
      body.mode-prep #phase-state,
      body.mode-prep #phase-timer-note,
      body.mode-prep #start-service {
        display: none;
      }

      body.mode-kitchen .ticket-meta {
        display: none;
      }

      body.mode-kitchen .ticket {
        padding: 10px;
      }

      body.mode-kitchen .ticket-title {
        font-size: 12px;
      }

      body.mode-kitchen .ticket-line {
        font-size: 12px;
      }

      body.mode-kitchen .person-name {
        font-size: 13px;
      }

      body.mode-kitchen .person-role,
      body.mode-kitchen .person-state {
        font-size: 11px;
      }

      .manual-box {
        display: none;
        margin-top: 6px;
      }

      body.manual-open .manual-box {
        display: block;
      }

      @media (max-width: 980px) {
        .topbar {
          grid-template-columns: 1fr;
        }

        .top-center {
          justify-items: flex-start;
        }

        .status-strip {
          justify-content: flex-start;
        }

        .main-actions {
          justify-content: flex-start;
        }
      }
